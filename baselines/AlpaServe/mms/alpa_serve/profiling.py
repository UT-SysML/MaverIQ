"""Profile the running time and memory usage of models"""
from collections import namedtuple
import csv
import dataclasses
import json
import pickle
from typing import List, Dict, Union, Any

from alpa_serve.util import GB


# 3D parallel configuration
# (data parallel, operator parallel, pipeline parallel)
ParallelConfig = namedtuple("ParallelConfig", ("dp", "op", "pp"))

@dataclasses.dataclass
class LatencyMemData:
    # The latency of each stage
    # Type: Dict[batch_size -> List[stage_latency]]
    latency: Dict
    # The activation memory of each stage
    # Type: Dict[batch_size -> List[stage_act_mem]]
    act_mem: Dict
    # The weight memory of each stage
    # Type: List[stage_weight_mem]
    weight_mem: List
    # Metadata for parallel strategy
    metadata: Any = None

    def add_result(self, batch_size: int, latency: List[float], act_mem: List[float], weight_mem: List[float], metadata: Any = None):
        if batch_size not in self.latency:
            self.latency[batch_size] = latency
            self.act_mem[batch_size] = act_mem
        else:
            new_max_latency = max(latency)
            old_max_latency = max(self.latency[batch_size])
            if new_max_latency < old_max_latency:
                self.latency[batch_size] = latency
                self.act_mem[batch_size] = act_mem
                self.weight_mem = weight_mem
                self.metadata = metadata


@dataclasses.dataclass
class ProfilingResult:
    """Store the profiling result of a model."""
    model_name: str
    # The latency and memory usage of each pipeline stage on GPUs.
    # type: Dict[parallel_config -> latency_mem]
    para_dict: Dict
    # The latency of preprocess on CPU.
    preprocess_cpu: float
    # The latency of postprocess on CPU.
    postprocess_cpu: float

    def add_result(self, parallel_config: ParallelConfig, batch_size: int,
                   stage_latency: List[float], act_mem: List[float], weight_mem: List[float],
                   metadata: Any = None):
        """Add or overwrite the profiling results of a model."""
        if parallel_config not in self.para_dict:
            self.para_dict[parallel_config] = LatencyMemData(
                latency={batch_size: stage_latency},
                act_mem={batch_size: act_mem},
                weight_mem=weight_mem,
                metadata=metadata)
        else:
            self.para_dict[parallel_config].add_result(batch_size, stage_latency,
                                                       act_mem, weight_mem, metadata)


class ProfilingDatabase:
    """Store the profiling results of all the models"""
    def __init__(self, database_filename: str, new_database: bool = False):
        # The file that backs up the profiling results.
        database_filename = '/home/mms/profiling_result.pkl'
        self.database_filename = database_filename
        # Dict[model_name -> ProfilingResult]
        self.results = {}
        if not new_database:
            with open(database_filename, "rb") as f:
                self.results = pickle.load(f)

    def get(self, model_name: str) -> ProfilingResult:
        return self.results.get(model_name)

    def update(self, result: ProfilingResult):
        self.results[result.model_name] = result

    def _extract_data(self, row):
        """Extract the profiling results from a row of the profiling CSV file."""
        stage_latencies = list(map(float, row["StageLatencies(s)"].strip("[]").split(",")))
        weight_mem = list(map(float, row["StageWeights(B)"].strip("[]").split(",")))
        peak_mem = list(map(float, row["StagePeakMem(B)"].strip("[]").split(",")))
        act_mem = [peak_mem - weight_mem for peak_mem, weight_mem in zip(peak_mem, weight_mem)]
        assert min(act_mem) > 0, "negative activation memory"
        parallel_config = ParallelConfig(int(row["DP"]), int(row["OP"]), int(row["PP"]))
        return row["ModelName"], parallel_config, int(row["BS"]), stage_latencies, weight_mem, act_mem

    def update_from_csv(self, file_name: str):
        # Add head if there is no head
        missing_head = False
        with open(file_name, "r") as f:
            l = f.readline()
            if l[0] != 'M':
                lines = [l] + f.readlines()
                missing_head = True

        if missing_head:
            heads = [
                "ModelName", "BS", "#Microbatch", "DP", "OP", "PP", "#GPU",
                "MeanTime(s)", "StdTime(s)", "TFLOPs", "StageWeights(B)",
                "StagePeakMem(B)", "StageLatencies(s)"
            ]
            lines = ["\t".join(heads) + "\n"] + lines
            with open(file_name, "w") as f:
                f.writelines(lines)

        # read lines
        results = {}
        with open(file_name, "r") as f:
            reader = csv.DictReader(f, delimiter="\t")
            for row in reader:
                model_name, parallel_config, batch_size, stage_latencies, weight_mem, act_mem = self._extract_data(row)
                if model_name not in results:
                    results[model_name] = ProfilingResult(
                                                            model_name,
                                                            {
                                                                parallel_config: LatencyMemData(
                                                                    latency={   # Dict[batch_size -> List[stage_latency]]
                                                                        batch_size: stage_latencies,
                                                                    },
                                                                    act_mem={   # Dict[batch_size -> List[stage_act_mem]]
                                                                        batch_size: act_mem,
                                                                    },
                                                                    weight_mem=weight_mem # List[stage_weight_mem]
                                                                )
                                                            },
                                                            preprocess_cpu=0.0,
                                                            postprocess_cpu=0.0
                                                        )
                else:
                    results[model_name].add_result(parallel_config, batch_size, stage_latencies, act_mem, weight_mem)
        self.results.update(results)

    def _extract_auto_data(self, row):
        """Extract the profiling results from a row of the profiling CSV file."""
        stage_latencies = list(map(float, row["StageLatencies(s)"].strip("[]").split(", ")))
        weight_mem = list(map(float, row["StageWeights(B)"].strip("[]").split(", ")))
        peak_mem = list(map(float, row["StagePeakMem(B)"].strip("[]").split(", ")))
        act_mem = [peak_mem - weight_mem for peak_mem, weight_mem in zip(peak_mem, weight_mem)]
        assert min(act_mem) > 0, "negative activation memory"
        metadata = eval(row["Metadata"])
        pp = len(metadata["submesh_shapes"])
        op = metadata["submesh_shapes"][0][1]
        parallel_config = ParallelConfig(1, op, pp)
        return row["ModelName"], parallel_config, int(row["BS"]), stage_latencies, weight_mem, act_mem, metadata

    def update_from_auto_csv(self, file_name: str):
        fieldnames = [
                "ModelName", "BS", "#Microbatch", "ParallelArgs", "MeanTime(s)",
                "StdTime(s)", "TFLOPs", "StageWeights(B)", "StagePeakMem(B)",
                "StageLatencies(s)", "Metadata", "TimeStamp"
            ]
        with open(file_name, "r") as f:
            reader = csv.DictReader(f, fieldnames=fieldnames, delimiter="\t")
            for row in reader:
                model_name, parallel_config, batch_size, stage_latencies, weight_mem, act_mem, metadata = self._extract_auto_data(row)
                print(model_name, parallel_config, batch_size, stage_latencies, weight_mem, act_mem, metadata)
                if model_name not in self.results:
                    self.results[model_name] = ProfilingResult(
                        model_name,
                        {
                            parallel_config: LatencyMemData(
                                latency={   # Dict[batch_size -> List[stage_latency]]
                                    batch_size: stage_latencies,
                                },
                                act_mem={   # Dict[batch_size -> List[stage_act_mem]]
                                    batch_size: act_mem,
                                },
                                weight_mem=weight_mem, # List[stage_weight_mem]
                                metadata=metadata,
                            )
                        },
                        preprocess_cpu=0.0,
                        postprocess_cpu=0.0
                    )
                else:
                    self.results[model_name].add_result(parallel_config, batch_size, stage_latencies, act_mem, weight_mem, metadata)


    def materialize(self):
        """Write the profiling results to the database file."""
        with open(self.database_filename, "wb") as f:
            pickle.dump(self.results, f)


def load_test_prof_result(name: str):
    """Load pre-defined profiling results for testing."""
    if name == "alpa/bert-1.3b":
        return ProfilingResult("alpa/bert-1.3b",
            para_dict={
                ParallelConfig(1, 1, 1): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.099],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        2.6*GB,
                    ],
                ),
                ParallelConfig(1, 1, 2): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.051, 0.052],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        1.3*GB, 1.3*GB,
                    ],
                ),
                ParallelConfig(1, 1, 4): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.028, 0.027, 0.027, 0.029],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO", "TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        0.65*GB, 0.65*GB, 0.65*GB, 0.65*GB,
                    ],
                ),
                ParallelConfig(1, 1, 8): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.015, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.016],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO"] * 8,
                    },
                    weight_mem=[0.325*GB] * 8,
                ),
            },
            preprocess_cpu=0,
            postprocess_cpu=0,
        )
    elif name == "alpa/bert-2.6b":
        return ProfilingResult("alpa/bert-2.6b",
            para_dict={
                ParallelConfig(1, 1, 1): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.148],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        5.2*GB,
                    ],
                ),
                ParallelConfig(1, 1, 2): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.075, 0.076],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        2.6*GB, 2.6*GB,
                    ],
                ),
            },
            preprocess_cpu=0,
            postprocess_cpu=0,
        )
    elif name == "test-2GB-100ms":
        return ProfilingResult("test-2GB-100ms",
            para_dict={
                ParallelConfig(1, 1, 1): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.100],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        2*GB,
                    ],
                ),
                ParallelConfig(1, 1, 2): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.051, 0.051],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        1*GB, 1*GB
                    ],
                ),
                ParallelConfig(1, 1, 4): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.026, 0.026, 0.026, 0.026],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO", "TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        0.5*GB, 0.5*GB, 0.5*GB, 0.5*GB
                    ],
                ),
            },
            preprocess_cpu=0,
            postprocess_cpu=0,
        )
    elif name == "test-4GB-150ms":
        return ProfilingResult("test-4GB-150ms",
            para_dict={
                ParallelConfig(1, 1, 1): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.150],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        4*GB,
                    ],
                ),
                ParallelConfig(1, 1, 2): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.076, 0.076],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        2*GB, 2*GB
                    ],
                ),
                ParallelConfig(1, 1, 4): LatencyMemData(
                    latency={     # Dict[batch_size -> List[stage_latency]]
                        1: [0.039, 0.039, 0.039, 0.039],
                    },
                    act_mem={     # Dict[batch_size -> List[stage_act_mem]]
                        1: ["TODO", "TODO", "TODO", "TODO"],
                    },
                    weight_mem=[  # List[stage_weight_mem]
                        1*GB, 1*GB, 1*GB, 1*GB
                    ],
                ),
            },
            preprocess_cpu=0,
            postprocess_cpu=0,
        )
    else:
        raise ValueError(f"Unsupported model: {name}")

# database = ProfilingDatabase("profiling_result.pkl", False)
# bert_1_3b = database.get("bert-1.3b")
# bert_2_6b = database.get("bert-2.6b")
# bert_6_7b = database.get("bert-6.7b")
# print(bert_1_3b.para_dict[ParallelConfig(1,4,4)].latency[8])
# print(bert_2_6b.para_dict[ParallelConfig(1,4,4)].latency[8])
# print(bert_6_7b.para_dict[ParallelConfig(1,4,4)].latency[8])

'''
profiling_dict = {'falcon-7b': ProfilingResult(model_name='falcon-7b', para_dict={ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.063712781, 0.063712781]}, act_mem={1: ['None', 'None']}, weight_mem=[2102248672.0167773, 2102248672.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.041597800600000005, 0.041597800600000005, 0.041597800600000005]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1525438613.3501103, 1525438613.3501103, 1525438613.3501103], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.133305582]}, act_mem={1: ['None']}, weight_mem=[3460860352.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.020692397766666665, 0.020692397766666665, 0.020692397766666665, 0.020692397766666665, 0.020692397766666665, 0.020692397766666665]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[948628554.6834437, 948628554.6834437, 948628554.6834437, 948628554.6834437, 948628554.6834437, 948628554.6834437], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.01790593228571428, 0.01790593228571428, 0.01790593228571428, 0.01790593228571428, 0.01790593228571428, 0.01790593228571428, 0.01790593228571428]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[866227117.7310629, 866227117.7310629, 866227117.7310629, 866227117.7310629, 866227117.7310629, 866227117.7310629, 866227117.7310629], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.03074300385, 0.03074300385, 0.03074300385, 0.03074300385]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1237033584.0167773, 1237033584.0167773, 1237033584.0167773, 1237033584.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.02468928412, 0.02468928412, 0.02468928412, 0.02468928412, 0.02468928412]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1063990566.416777, 1063990566.416777, 1063990566.416777, 1063990566.416777, 1063990566.416777], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.015469282400000001, 0.015469282400000001, 0.015469282400000001, 0.015469282400000001, 0.015469282400000001, 0.015469282400000001, 0.015469282400000001, 0.015469282400000001]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[804426040.0167773, 804426040.0167773, 804426040.0167773, 804426040.0167773, 804426040.0167773, 804426040.0167773, 804426040.0167773, 804426040.0167773], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'falcon-40b': ProfilingResult(model_name='falcon-40b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.1151456823, 0.1151456823]}, act_mem={1: ['None', 'None']}, weight_mem=[3922887679.492489, 3922887679.492489], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.2380995064]}, act_mem={1: ['None']}, weight_mem=[7024543744.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.3557251014]}, act_mem={1: ['None']}, weight_mem=[11566911488.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.11323070333333334, 0.11323070333333334, 0.11323070333333334]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[4266252970.152166, 4266252970.152166, 4266252970.152166], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.1711553526, 0.1711553526]}, act_mem={1: ['None', 'None']}, weight_mem=[6194071551.488295, 6194071551.488295], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.08490289595, 0.08490289595, 0.08490289595, 0.08490289595]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3302343679.4841003, 3302343679.4841003, 3302343679.4841003, 3302343679.4841003], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.2990247956]}, act_mem={1: ['None']}, weight_mem=[4753359872.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.30020543380000003, 0.30020543380000003]}, act_mem={1: ['None', 'None']}, weight_mem=[10736439295.479906, 10736439295.479906], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.198425759, 0.198425759, 0.198425759]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[7294498132.813239, 7294498132.813239, 7294498132.813239], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.6173814143999999]}, act_mem={1: ['None']}, weight_mem=[20651646976.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.0987525374, 0.0987525374, 0.0987525374, 0.0987525374, 0.0987525374, 0.0987525374]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3852556970.1465735, 3852556970.1465735, 3852556970.1465735, 3852556970.1465735, 3852556970.1465735, 3852556970.1465735], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.08474498802857143, 0.08474498802857143, 0.08474498802857143, 0.08474498802857143, 0.08474498802857143, 0.08474498802857143, 0.08474498802857143]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3360851089.76562, 3360851089.76562, 3360851089.76562, 3360851089.76562, 3360851089.76562, 3360851089.76562, 3360851089.76562], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.1480867276, 0.1480867276, 0.1480867276, 0.1480867276]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[5573527551.479906, 5573527551.479906, 5573527551.479906, 5573527551.479906], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.11844100228000001, 0.11844100228000001, 0.11844100228000001, 0.11844100228000001, 0.11844100228000001]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[4540945202.679906, 4540945202.679906, 4540945202.679906, 4540945202.679906, 4540945202.679906], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.074115842825, 0.074115842825, 0.074115842825, 0.074115842825, 0.074115842825, 0.074115842825, 0.074115842825, 0.074115842825]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2992071679.479906, 2992071679.479906, 2992071679.479906, 2992071679.479906, 2992071679.479906, 2992071679.479906, 2992071679.479906, 2992071679.479906], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'gptj-6b': ProfilingResult(model_name='gptj-6b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.0326488218, 0.0326488218]}, act_mem={1: ['None', 'None']}, weight_mem=[1465856590.02936, 1465856590.02936], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.066916912]}, act_mem={1: ['None']}, weight_mem=[2158716060.0251656], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.0827106456]}, act_mem={1: ['None']}, weight_mem=[2447624504.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.025731273666666665, 0.025731273666666665, 0.025731273666666665]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1202373394.6890364, 1202373394.6890364, 1202373394.6890364], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.0388368168, 0.0388368168]}, act_mem={1: ['None', 'None']}, weight_mem=[1610310812.0251658, 1610310812.0251658], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.019247518999999998, 0.019247518999999998, 0.019247518999999998, 0.019247518999999998]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[998404686.0209715, 998404686.0209715, 998404686.0209715, 998404686.0209715], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.0906697846]}, act_mem={1: ['None']}, weight_mem=[2014261838.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.0567288237, 0.0567288237]}, act_mem={1: ['None', 'None']}, weight_mem=[1899219256.0167773, 1899219256.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.0367417628, 0.0367417628, 0.0367417628]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1394979024.0167773, 1394979024.0167773, 1394979024.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.11995558740000001]}, act_mem={1: ['None']}, weight_mem=[3025441392.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.018500452366666666, 0.018500452366666666, 0.018500452366666666, 0.018500452366666666, 0.018500452366666666, 0.018500452366666666]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[890738792.0167774, 890738792.0167774, 890738792.0167774, 890738792.0167774, 890738792.0167774, 890738792.0167774], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.015724143428571428, 0.015724143428571428, 0.015724143428571428, 0.015724143428571428, 0.015724143428571428, 0.015724143428571428, 0.015724143428571428]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[818704473.1596344, 818704473.1596344, 818704473.1596344, 818704473.1596344, 818704473.1596344, 818704473.1596344, 818704473.1596344], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.02737773325, 0.02737773325, 0.02737773325, 0.02737773325]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1142858908.0167773, 1142858908.0167773, 1142858908.0167773, 1142858908.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.022172424320000002, 0.022172424320000002, 0.022172424320000002, 0.022172424320000002, 0.022172424320000002]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[991586838.416777, 991586838.416777, 991586838.416777, 991586838.416777, 991586838.416777], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.01398108435, 0.01398108435, 0.01398108435, 0.01398108435, 0.01398108435, 0.01398108435, 0.01398108435, 0.01398108435]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[764678734.0167773, 764678734.0167773, 764678734.0167773, 764678734.0167773, 764678734.0167773, 764678734.0167773, 764678734.0167773, 764678734.0167773], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-7b': ProfilingResult(model_name='llama-2-7b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.0559817438, 0.0559817438]}, act_mem={1: ['None', 'None']}, weight_mem=[1428349183.4924893, 1428349183.4924893], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.1191118564]}, act_mem={1: ['None']}, weight_mem=[2085798400.0251658], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.09397414779999999]}, act_mem={1: ['None']}, weight_mem=[2513601536.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.0289551608, 0.0289551608, 0.0289551608]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1223317162.1521654, 1223317162.1521654, 1223317162.1521654], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.0435428343, 0.0435428343]}, act_mem={1: ['None', 'None']}, weight_mem=[1642250751.4882948, 1642250751.4882948], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.02148983715, 0.02148983715, 0.02148983715, 0.02148983715]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1013850367.4841006, 1013850367.4841006, 1013850367.4841006, 1013850367.4841006], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.06409898950000001, 0.06409898950000001]}, act_mem={1: ['None', 'None']}, weight_mem=[2070053887.4799063, 2070053887.4799063], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.0413191484, 0.0413191484, 0.0413191484]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1508519252.8132393, 1508519252.8132393, 1508519252.8132393], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.1345345536]}, act_mem={1: ['None']}, weight_mem=[3369207808.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.020518289566666667, 0.020518289566666667, 0.020518289566666667, 0.020518289566666667, 0.020518289566666667, 0.020518289566666667]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[946984618.146573, 946984618.146573, 946984618.146573, 946984618.146573, 946984618.146573, 946984618.146573], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.017860107428571432, 0.017860107428571432, 0.017860107428571432, 0.017860107428571432, 0.017860107428571432, 0.017860107428571432, 0.017860107428571432]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[866765384.6227634, 866765384.6227634, 866765384.6227634, 866765384.6227634, 866765384.6227634, 866765384.6227634, 866765384.6227634], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.0306802988, 0.0306802988, 0.0306802988, 0.0306802988]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1227751935.4799063, 1227751935.4799063, 1227751935.4799063, 1227751935.4799063], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.024610113519999997, 0.024610113519999997, 0.024610113519999997, 0.024610113519999997, 0.024610113519999997]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1059291545.0799062, 1059291545.0799062, 1059291545.0799062, 1059291545.0799062, 1059291545.0799062], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.015488820075000001, 0.015488820075000001, 0.015488820075000001, 0.015488820075000001, 0.015488820075000001, 0.015488820075000001, 0.015488820075000001, 0.015488820075000001]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[806600959.4799063, 806600959.4799063, 806600959.4799063, 806600959.4799063, 806600959.4799063, 806600959.4799063, 806600959.4799063, 806600959.4799063], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-13b': ProfilingResult(model_name='llama-2-13b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.051079847, 0.051079847]}, act_mem={1: ['None', 'None']}, weight_mem=[1873118528.02936, 1873118528.02936], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.12387981420000001]}, act_mem={1: ['None']}, weight_mem=[2977434240.0251656], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.1485814208]}, act_mem={1: ['None']}, weight_mem=[4154266880.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.04614724413333333, 0.04614724413333333, 0.04614724413333333]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[1769157034.6890364, 1769157034.6890364, 1769157034.6890364], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.0700655813, 0.0700655813]}, act_mem={1: ['None', 'None']}, weight_mem=[2461534848.0251656, 2461534848.0251656], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.03432457875, 0.03432457875, 0.03432457875, 0.03432457875]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1422968128.0209715, 1422968128.0209715, 1422968128.0209715, 1422968128.0209715], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.141418825]}, act_mem={1: ['None']}, weight_mem=[2389017920.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.1111639194, 0.1111639194]}, act_mem={1: ['None', 'None']}, weight_mem=[3638367488.016777, 3638367488.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.0727974644, 0.0727974644, 0.0727974644]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2553712128.016777, 2553712128.016777, 2553712128.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.2310486488]}, act_mem={1: ['None']}, weight_mem=[6507932160.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.0357898871, 0.0357898871, 0.0357898871, 0.0357898871, 0.0357898871, 0.0357898871]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1469056768.0167773, 1469056768.0167773, 1469056768.0167773, 1469056768.0167773, 1469056768.0167773, 1469056768.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.030592576714285717, 0.030592576714285717, 0.030592576714285717, 0.030592576714285717, 0.030592576714285717, 0.030592576714285717, 0.030592576714285717]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1314106002.3024914, 1314106002.3024914, 1314106002.3024914, 1314106002.3024914, 1314106002.3024914, 1314106002.3024914, 1314106002.3024914], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.0538827791, 0.0538827791, 0.0538827791, 0.0538827791]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2011384448.0167773, 2011384448.0167773, 2011384448.0167773, 2011384448.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.042848232279999995, 0.042848232279999995, 0.042848232279999995, 0.042848232279999995, 0.042848232279999995]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1685987840.0167773, 1685987840.0167773, 1685987840.0167773, 1685987840.0167773, 1685987840.0167773], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.026479374174999997, 0.026479374174999997, 0.026479374174999997, 0.026479374174999997, 0.026479374174999997, 0.026479374174999997, 0.026479374174999997, 0.026479374174999997]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1197892928.0167773, 1197892928.0167773, 1197892928.0167773, 1197892928.0167773, 1197892928.0167773, 1197892928.0167773, 1197892928.0167773, 1197892928.0167773], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-70b': ProfilingResult(model_name='llama-2-70b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.1944773502, 0.1944773502]}, act_mem={1: ['None', 'None']}, weight_mem=[5483364864.092275, 5483364864.092275], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.4025803834]}, act_mem={1: ['None']}, weight_mem=[10088875008.150995], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.5832123336]}, act_mem={1: ['None']}, weight_mem=[18222024704.100662], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.1843525365333333, 0.1843525365333333, 0.1843525365333333]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[6512935594.716998, 6512935594.716998, 6512935594.716998], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.2784149933, 0.2784149933]}, act_mem={1: ['None', 'None']}, weight_mem=[9549939712.067108, 9549939712.067108], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.13732295035, 0.13732295035, 0.13732295035, 0.13732295035]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4994433536.041943, 4994433536.041943, 4994433536.041943, 4994433536.041943], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0)}
'''
'''
profiling_dict = {'falcon-7b': ProfilingResult(model_name='falcon-7b', para_dict={ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.15548485279083252, 0.15548485279083252]}, act_mem={1: ['None', 'None']}, weight_mem=[7293539200.016777, 7293539200.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.10281657854715982, 0.10281657854715982, 0.10281657854715982]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[4986298965.35011, 4986298965.35011, 4986298965.35011], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.31874942588806154]}, act_mem={1: ['None']}, weight_mem=[13843441408.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.05136689058939616, 0.05136689058939616, 0.05136689058939616, 0.05136689058939616, 0.05136689058939616, 0.05136689058939616]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2679058730.6834435, 2679058730.6834435, 2679058730.6834435, 2679058730.6834435, 2679058730.6834435, 2679058730.6834435], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.04424489457266671, 0.04424489457266671, 0.04424489457266671, 0.04424489457266671, 0.04424489457266671, 0.04424489457266671, 0.04424489457266671]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2349452982.87392, 2349452982.87392, 2349452982.87392, 2349452982.87392, 2349452982.87392, 2349452982.87392, 2349452982.87392], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.07675189590454101, 0.07675189590454101, 0.07675189590454101, 0.07675189590454101]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3832678848.016777, 3832678848.016777, 3832678848.016777, 3832678848.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.06155555114746094, 0.06155555114746094, 0.06155555114746094, 0.06155555114746094, 0.06155555114746094]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[3140506777.616777, 3140506777.616777, 3140506777.616777, 3140506777.616777, 3140506777.616777], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.03846074342727661, 0.03846074342727661, 0.03846074342727661, 0.03846074342727661, 0.03846074342727661, 0.03846074342727661, 0.03846074342727661, 0.03846074342727661]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2102248672.0167773, 2102248672.0167773, 2102248672.0167773, 2102248672.0167773, 2102248672.0167773, 2102248672.0167773, 2102248672.0167773, 2102248672.0167773], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'falcon-40b': ProfilingResult(model_name='falcon-40b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.25894008922576905, 0.25894008922576905]}, act_mem={1: ['None', 'None']}, weight_mem=[11667255295.492489, 11667255295.492489], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.5237746334075928]}, act_mem={1: ['None']}, weight_mem=[22513278976.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.9225745754241943]}, act_mem={1: ['None']}, weight_mem=[42544381952.01678], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.3020315297444662, 0.3020315297444662, 0.3020315297444662]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[14592076458.152166, 14592076458.152166, 14592076458.152166], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.45431058502197263, 0.45431058502197263]}, act_mem={1: ['None', 'None']}, weight_mem=[21682806783.488297, 21682806783.488297], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.2261324110031128, 0.2261324110031128, 0.2261324110031128, 0.2261324110031128]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[11046711295.4841, 11046711295.4841, 11046711295.4841, 11046711295.4841], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.45227652168273924]}, act_mem={1: ['None']}, weight_mem=[12497727488.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.8616453952789307, 0.8616453952789307]}, act_mem={1: ['None', 'None']}, weight_mem=[41713909759.479904, 41713909759.479904], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.5726424344380696, 0.5726424344380696, 0.5726424344380696]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[27946145108.813244, 27946145108.813244, 27946145108.813244], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.285521463394165, 0.285521463394165, 0.285521463394165, 0.285521463394165, 0.285521463394165, 0.285521463394165]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[14178380458.14657, 14178380458.14657, 14178380458.14657, 14178380458.14657, 14178380458.14657, 14178380458.14657], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.24497961180550712, 0.24497961180550712, 0.24497961180550712, 0.24497961180550712, 0.24497961180550712, 0.24497961180550712, 0.24497961180550712]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[12211556936.622763, 12211556936.622763, 12211556936.622763, 12211556936.622763, 12211556936.622763, 12211556936.622763, 12211556936.622763], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.4287985157966614, 0.4287985157966614, 0.4287985157966614, 0.4287985157966614]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[21062262783.479908, 21062262783.479908, 21062262783.479908, 21062262783.479908], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.3431668685913086, 0.3431668685913086, 0.3431668685913086, 0.3431668685913086, 0.3431668685913086]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[16931933388.279903, 16931933388.279903, 16931933388.279903, 16931933388.279903, 16931933388.279903], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.21404557323455808, 0.21404557323455808, 0.21404557323455808, 0.21404557323455808, 0.21404557323455808, 0.21404557323455808, 0.21404557323455808, 0.21404557323455808]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[10736439295.479906, 10736439295.479906, 10736439295.479906, 10736439295.479906, 10736439295.479906, 10736439295.479906, 10736439295.479906, 10736439295.479906], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'gptj-6b': ProfilingResult(model_name='gptj-6b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.05456305027008057, 0.05456305027008057]}, act_mem={1: ['None', 'None']}, weight_mem=[2600397112.02936, 2600397112.02936], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.11084870910644531]}, act_mem={1: ['None']}, weight_mem=[4427797104.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.1643781089782715]}, act_mem={1: ['None']}, weight_mem=[6985786592.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.05321878178914388, 0.05321878178914388, 0.05321878178914388]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2715094090.689036, 2715094090.689036, 2715094090.689036], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.0796670742034912, 0.0796670742034912]}, act_mem={1: ['None', 'None']}, weight_mem=[3879391856.0251656, 3879391856.0251656], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.03980435037612915, 0.03980435037612915, 0.03980435037612915, 0.03980435037612915]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2132945208.0209715, 2132945208.0209715, 2132945208.0209715, 2132945208.0209715], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.11773676109313964]}, act_mem={1: ['None']}, weight_mem=[3148802360.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.1358229103088379, 0.1358229103088379]}, act_mem={1: ['None', 'None']}, weight_mem=[6437381344.016777, 6437381344.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.08950990613301595, 0.08950990613301595, 0.08950990613301595]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[4420420416.016777, 4420420416.016777, 4420420416.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.27954444313049315]}, act_mem={1: ['None']}, weight_mem=[12101765568.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.044985782305399576, 0.044985782305399576, 0.044985782305399576, 0.044985782305399576, 0.044985782305399576, 0.044985782305399576]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2403459488.016777, 2403459488.016777, 2403459488.016777, 2403459488.016777, 2403459488.016777, 2403459488.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.038470177514212466, 0.038470177514212466, 0.038470177514212466, 0.038470177514212466, 0.038470177514212466, 0.038470177514212466, 0.038470177514212466]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2115322212.5882058, 2115322212.5882058, 2115322212.5882058, 2115322212.5882058, 2115322212.5882058, 2115322212.5882058, 2115322212.5882058], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.06716776132583618, 0.06716776132583618, 0.06716776132583618, 0.06716776132583618]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3411939952.016777, 3411939952.016777, 3411939952.016777, 3411939952.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.05393498954772948, 0.05393498954772948, 0.05393498954772948, 0.05393498954772948, 0.05393498954772948]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[2806851673.616777, 2806851673.616777, 2806851673.616777, 2806851673.616777, 2806851673.616777], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.033882905244827274, 0.033882905244827274, 0.033882905244827274, 0.033882905244827274, 0.033882905244827274, 0.033882905244827274, 0.033882905244827274, 0.033882905244827274]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1899219256.0167773, 1899219256.0167773, 1899219256.0167773, 1899219256.0167773, 1899219256.0167773, 1899219256.0167773, 1899219256.0167773, 1899219256.0167773], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-7b': ProfilingResult(model_name='llama-2-7b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.09573827075958252, 0.09573827075958252]}, act_mem={1: ['None', 'None']}, weight_mem=[2691802111.492489, 2691802111.492489], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.13159210777282715]}, act_mem={1: ['None']}, weight_mem=[4612704256.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.18678712654113766]}, act_mem={1: ['None']}, weight_mem=[7567413248.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.06028533744812012, 0.06028533744812012, 0.06028533744812012]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2907921066.152166, 2907921066.152166, 2907921066.152166], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.09034583377838136, 0.09034583377838136]}, act_mem={1: ['None', 'None']}, weight_mem=[4169156607.4882946, 4169156607.4882946], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.04502349662780762, 0.04502349662780762, 0.04502349662780762, 0.04502349662780762]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2277303295.4841003, 2277303295.4841003, 2277303295.4841003, 2277303295.4841003], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.1606906394958496]}, act_mem={1: ['None']}, weight_mem=[3135349760.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.1565159912109375, 0.1565159912109375]}, act_mem={1: ['None', 'None']}, weight_mem=[7123865599.479906, 7123865599.479906], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.10305217552185059, 0.10305217552185059, 0.10305217552185059]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[4877727060.813239, 4877727060.813239, 4877727060.813239], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.32132472610473634]}, act_mem={1: ['None']}, weight_mem=[13476831232.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.05152121734619142, 0.05152121734619142, 0.05152121734619142, 0.05152121734619142, 0.05152121734619142, 0.05152121734619142]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2631588522.146573, 2631588522.146573, 2631588522.146573, 2631588522.146573, 2631588522.146573, 2631588522.146573], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.0444789480481829, 0.0444789480481829, 0.0444789480481829, 0.0444789480481829, 0.0444789480481829, 0.0444789480481829, 0.0444789480481829]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2310711588.051335, 2310711588.051335, 2310711588.051335, 2310711588.051335, 2310711588.051335, 2310711588.051335, 2310711588.051335], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.0770670337677002, 0.0770670337677002, 0.0770670337677002, 0.0770670337677002]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3754657791.479906, 3754657791.479906, 3754657791.479906, 3754657791.479906], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.061927677536010736, 0.061927677536010736, 0.061927677536010736, 0.061927677536010736, 0.061927677536010736]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[3080816229.8799067, 3080816229.8799067, 3080816229.8799067, 3080816229.8799067, 3080816229.8799067], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.03870392966270447, 0.03870392966270447, 0.03870392966270447, 0.03870392966270447, 0.03870392966270447, 0.03870392966270447, 0.03870392966270447, 0.03870392966270447]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2070053887.4799063, 2070053887.4799063, 2070053887.4799063, 2070053887.4799063, 2070053887.4799063, 2070053887.4799063, 2070053887.4799063, 2070053887.4799063], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-13b': ProfilingResult(model_name='llama-2-13b', para_dict={ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.10314255714416505, 0.10314255714416505]}, act_mem={1: ['None', 'None']}, weight_mem=[4313593088.02936, 4313593088.02936], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.20881558990478521]}, act_mem={1: ['None']}, weight_mem=[7858383360.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.329581413269043]}, act_mem={1: ['None']}, weight_mem=[13916165120.016777], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.10695455233256022, 0.10695455233256022, 0.10695455233256022]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5023123114.689036, 5023123114.689036, 5023123114.689036], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.16048967361450198, 0.16048967361450198]}, act_mem={1: ['None', 'None']}, weight_mem=[7342483968.025166, 7342483968.025166], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.07985354709625245, 0.07985354709625245, 0.07985354709625245, 0.07985354709625245]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3863442688.0209713, 3863442688.0209713, 3863442688.0209713, 3863442688.0209713], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.2448089199066162]}, act_mem={1: ['None']}, weight_mem=[4829492480.02936], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.28636539459228516, 0.28636539459228516]}, act_mem={1: ['None', 'None']}, weight_mem=[13400265728.016777, 13400265728.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.1895455354054769, 0.1895455354054769, 0.1895455354054769]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[9061644288.016777, 9061644288.016777, 9061644288.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.5852332973480225]}, act_mem={1: ['None']}, weight_mem=[26031728640.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.09442784627278646, 0.09442784627278646, 0.09442784627278646, 0.09442784627278646, 0.09442784627278646, 0.09442784627278646]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4723022848.016777, 4723022848.016777, 4723022848.016777, 4723022848.016777, 4723022848.016777, 4723022848.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.08111758831569127, 0.08111758831569127, 0.08111758831569127, 0.08111758831569127, 0.08111758831569127, 0.08111758831569127, 0.08111758831569127]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4103219785.159634, 4103219785.159634, 4103219785.159634, 4103219785.159634, 4103219785.159634, 4103219785.159634, 4103219785.159634], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.14184457921981813, 0.14184457921981813, 0.14184457921981813, 0.14184457921981813]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[6892333568.016777, 6892333568.016777, 6892333568.016777, 6892333568.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.11330902862548828, 0.11330902862548828, 0.11330902862548828, 0.11330902862548828, 0.11330902862548828]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[5590747136.016777, 5590747136.016777, 5590747136.016777, 5590747136.016777, 5590747136.016777], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.0706366777420044, 0.0706366777420044, 0.0706366777420044, 0.0706366777420044, 0.0706366777420044, 0.0706366777420044, 0.0706366777420044, 0.0706366777420044]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3638367488.016777, 3638367488.016777, 3638367488.016777, 3638367488.016777, 3638367488.016777, 3638367488.016777, 3638367488.016777, 3638367488.016777], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-70b': ProfilingResult(model_name='llama-2-70b', para_dict={ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.7564978853861491, 0.7564978853861491, 0.7564978853861491]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[23757097642.717, 23757097642.717, 23757097642.717], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.5662806134223939, 0.5662806134223939, 0.5662806134223939, 0.5662806134223939]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[17927555072.041943, 17927555072.041943, 17927555072.041943, 17927555072.041943], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [1.3080761051177978]}, act_mem={1: ['None']}, weight_mem=[18955421696.176163], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.7186870155334472, 0.7186870155334472, 0.7186870155334472, 0.7186870155334472, 0.7186870155334472, 0.7186870155334472]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[23431143424.016773, 23431143424.016773, 23431143424.016773, 23431143424.016773, 23431143424.016773, 23431143424.016773], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.6160666127886092, 0.6160666127886092, 0.6160666127886092, 0.6160666127886092, 0.6160666127886092, 0.6160666127886092, 0.6160666127886092]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[20146541129.159634, 20146541129.159634, 20146541129.159634, 20146541129.159634, 20146541129.159634, 20146541129.159634, 20146541129.159634], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [1.0789654092788699, 1.0789654092788699, 1.0789654092788699, 1.0789654092788699]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[34927251456.01678, 34927251456.01678, 34927251456.01678, 34927251456.01678], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.8631019786834718, 0.8631019786834718, 0.8631019786834718, 0.8631019786834718, 0.8631019786834718]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[28029586636.81678, 28029586636.81678, 28029586636.81678, 28029586636.81678, 28029586636.81678], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.5387897024154663, 0.5387897024154663, 0.5387897024154663, 0.5387897024154663, 0.5387897024154663, 0.5387897024154663, 0.5387897024154663, 0.5387897024154663]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[17683089408.016777, 17683089408.016777, 17683089408.016777, 17683089408.016777, 17683089408.016777, 17683089408.016777, 17683089408.016777, 17683089408.016777], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [1.3420799160003662]}, act_mem={1: ['None']}, weight_mem=[35955118080.15099], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.43370904541015626, 0.43370904541015626]}, act_mem={1: ['None', 'None']}, weight_mem=[18416486400.092274, 18416486400.092274], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.7521105852127075, 0.7521105852127075]}, act_mem={1: ['None', 'None']}, weight_mem=[35416182784.06711, 35416182784.06711], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0)}
'''
# New Float16
profiling_dict = {'falcon-7b': ProfilingResult(model_name='falcon-7b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.1156165599822998]}, act_mem={1: ['None']}, weight_mem=[14985396224.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.05620284875233968, 0.05620284875233968]}, act_mem={1: ['None', 'None']}, weight_mem=[7972519936.0, 7972519936.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.0369464980231391, 0.0369464980231391, 0.0369464980231391]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5669847040.0, 5669847040.0, 5669847040.0], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.027532319227854412, 0.027532319227854412, 0.027532319227854412, 0.027532319227854412]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4639621120.0, 4639621120.0, 4639621120.0, 4639621120.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.02209148089090983, 0.02209148089090983, 0.02209148089090983, 0.02209148089090983, 0.02209148089090983]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[3778635366.4, 3778635366.4, 3778635366.4, 3778635366.4, 3778635366.4], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.018427830272250704, 0.018427830272250704, 0.018427830272250704, 0.018427830272250704, 0.018427830272250704, 0.018427830272250704]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3430438229.3333335, 3430438229.3333335, 3430438229.3333335, 3430438229.3333335, 3430438229.3333335, 3430438229.3333335], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.01580775805882045, 0.01580775805882045, 0.01580775805882045, 0.01580775805882045, 0.01580775805882045, 0.01580775805882045, 0.01580775805882045]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2966318518.857143, 2966318518.857143, 2966318518.857143, 2966318518.857143, 2966318518.857143, 2966318518.857143, 2966318518.857143], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.013855836788813271, 0.013855836788813271, 0.013855836788813271, 0.013855836788813271, 0.013855836788813271, 0.013855836788813271, 0.013855836788813271, 0.013855836788813271]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2841575424.0, 2841575424.0, 2841575424.0, 2841575424.0, 2841575424.0, 2841575424.0, 2841575424.0, 2841575424.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'falcon-40b': ProfilingResult(model_name='falcon-40b', para_dict={ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.310721230506897, 0.310721230506897]}, act_mem={1: ['None', 'None']}, weight_mem=[42793631744.0, 42793631744.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.20664230982462564, 0.20664230982462564, 0.20664230982462564]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[28928660821.333332, 28928660821.333332, 28928660821.333332], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.15457026958465575, 0.15457026958465575, 0.15457026958465575, 0.15457026958465575]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[22087925760.0, 22087925760.0, 22087925760.0, 22087925760.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.1237861696879069, 0.1237861696879069, 0.1237861696879069, 0.1237861696879069, 0.1237861696879069]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[17816551424.0, 17816551424.0, 17816551424.0, 17816551424.0, 17816551424.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.10298242304060194, 0.10298242304060194, 0.10298242304060194, 0.10298242304060194, 0.10298242304060194, 0.10298242304060194]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[15128352085.333334, 15128352085.333334, 15128352085.333334, 15128352085.333334, 15128352085.333334, 15128352085.333334], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.08817837578909737, 0.08817837578909737, 0.08817837578909737, 0.08817837578909737, 0.08817837578909737, 0.08817837578909737, 0.08817837578909737]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[13000891245.714285, 13000891245.714285, 13000891245.714285, 13000891245.714285, 13000891245.714285, 13000891245.714285, 13000891245.714285], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.07727119326591492, 0.07727119326591492, 0.07727119326591492, 0.07727119326591492, 0.07727119326591492, 0.07727119326591492, 0.07727119326591492, 0.07727119326591492]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[11637817344.0, 11637817344.0, 11637817344.0, 11637817344.0, 11637817344.0, 11637817344.0, 11637817344.0, 11637817344.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.3395692189534506]}, act_mem={1: ['None']}, weight_mem=[43434508288.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.16812361081441246, 0.16812361081441246]}, act_mem={1: ['None', 'None']}, weight_mem=[22615031808.0, 22615031808.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.11207901106940377, 0.11207901106940377, 0.11207901106940377]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[15559163904.0, 15559163904.0, 15559163904.0], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.08429721196492515, 0.08429721196492515, 0.08429721196492515, 0.08429721196492515]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[12017074176.0, 12017074176.0, 12017074176.0, 12017074176.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.19463443756103516]}, act_mem={1: ['None']}, weight_mem=[23504093184.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.0975043773651123, 0.0975043773651123]}, act_mem={1: ['None', 'None']}, weight_mem=[12995002368.0, 12995002368.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.18231512705485026]}, act_mem={1: ['None']}, weight_mem=[14287110144.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'gptj-6b': ProfilingResult(model_name='gptj-6b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.09944057464599608]}, act_mem={1: ['None']}, weight_mem=[13121028096.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.04844911893208821, 0.04844911893208821]}, act_mem={1: ['None', 'None']}, weight_mem=[7047675904.0, 7047675904.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.031764708624945744, 0.031764708624945744, 0.031764708624945744]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5089634986.666667, 5089634986.666667, 5089634986.666667], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.02377563714981079, 0.02377563714981079, 0.02377563714981079, 0.02377563714981079]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4206034944.0, 4206034944.0, 4206034944.0, 4206034944.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.019114751815795895, 0.019114751815795895, 0.019114751815795895, 0.019114751815795895, 0.019114751815795895]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[3472451174.4, 3472451174.4, 3472451174.4, 3472451174.4, 3472451174.4], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.015974556075202092, 0.015974556075202092, 0.015974556075202092, 0.015974556075202092, 0.015974556075202092, 0.015974556075202092]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3160954197.3333335, 3160954197.3333335, 3160954197.3333335, 3160954197.3333335, 3160954197.3333335, 3160954197.3333335], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.013676216488792784, 0.013676216488792784, 0.013676216488792784, 0.013676216488792784, 0.013676216488792784, 0.013676216488792784, 0.013676216488792784]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2768886637.714286, 2768886637.714286, 2768886637.714286, 2768886637.714286, 2768886637.714286, 2768886637.714286, 2768886637.714286], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.011961692571640014, 0.011961692571640014, 0.011961692571640014, 0.011961692571640014, 0.011961692571640014, 0.011961692571640014, 0.011961692571640014, 0.011961692571640014]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2652045312.0, 2652045312.0, 2652045312.0, 2652045312.0, 2652045312.0, 2652045312.0, 2652045312.0, 2652045312.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.06150232950846354]}, act_mem={1: ['None']}, weight_mem=[7501905920.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.030517466862996417, 0.030517466862996417]}, act_mem={1: ['None', 'None']}, weight_mem=[4623040512.0, 4623040512.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.020710600747002494, 0.020710600747002494, 0.020710600747002494]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[3557512533.3333335, 3557512533.3333335, 3557512533.3333335], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.015732395648956298, 0.015732395648956298, 0.015732395648956298, 0.015732395648956298]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3029991424.0, 3029991424.0, 3029991424.0, 3029991424.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.06130417188008626]}, act_mem={1: ['None']}, weight_mem=[5178654720.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.03186976909637451, 0.03186976909637451]}, act_mem={1: ['None', 'None']}, weight_mem=[3774611456.0, 3774611456.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.16156090100606282]}, act_mem={1: ['None']}, weight_mem=[4772069376.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-7b': ProfilingResult(model_name='llama-2-7b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.11414348284403483]}, act_mem={1: ['None']}, weight_mem=[14572257280.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.055955910682678224, 0.055955910682678224]}, act_mem={1: ['None', 'None']}, weight_mem=[7783776256.0, 7783776256.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.036928388807508684, 0.036928388807508684, 0.036928388807508684]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5578970453.333333, 5578970453.333333, 5578970453.333333], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.027630213896433515, 0.027630213896433515, 0.027630213896433515, 0.027630213896433515]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4522704896.0, 4522704896.0, 4522704896.0, 4522704896.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.022059055964152016, 0.022059055964152016, 0.022059055964152016, 0.022059055964152016, 0.022059055964152016]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[3730820300.8, 3730820300.8, 3730820300.8, 3730820300.8, 3730820300.8], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.018348222308688693, 0.018348222308688693, 0.018348222308688693, 0.018348222308688693, 0.018348222308688693, 0.018348222308688693]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3381155157.3333335, 3381155157.3333335, 3381155157.3333335, 3381155157.3333335, 3381155157.3333335, 3381155157.3333335], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.01574489956810361, 0.01574489956810361, 0.01574489956810361, 0.01574489956810361, 0.01574489956810361, 0.01574489956810361, 0.01574489956810361]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2936059611.428571, 2936059611.428571, 2936059611.428571, 2936059611.428571, 2936059611.428571, 2936059611.428571, 2936059611.428571], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.013919228315353393, 0.013919228315353393, 0.013919228315353393, 0.013919228315353393, 0.013919228315353393, 0.013919228315353393, 0.013919228315353393, 0.013919228315353393]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2814050304.0, 2814050304.0, 2814050304.0, 2814050304.0, 2814050304.0, 2814050304.0, 2814050304.0, 2814050304.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.06854626337687174]}, act_mem={1: ['None']}, weight_mem=[8166703104.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.03363481362660726, 0.03363481362660726]}, act_mem={1: ['None', 'None']}, weight_mem=[4910874624.0, 4910874624.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.02258604367574056, 0.02258604367574056, 0.02258604367574056]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[3743110485.3333335, 3743110485.3333335, 3743110485.3333335], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.017138842741648355, 0.017138842741648355, 0.017138842741648355, 0.017138842741648355]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3185704960.0, 3185704960.0, 3185704960.0, 3185704960.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.09745078086853026]}, act_mem={1: ['None']}, weight_mem=[5408292864.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.04833312034606933, 0.04833312034606933]}, act_mem={1: ['None', 'None']}, weight_mem=[3929538560.0, 3929538560.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.3174539566040039]}, act_mem={1: ['None']}, weight_mem=[4812963840.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-13b': ProfilingResult(model_name='llama-2-13b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.20774842898050944]}, act_mem={1: ['None']}, weight_mem=[27455062016.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.09970551331837972, 0.09970551331837972]}, act_mem={1: ['None', 'None']}, weight_mem=[14257684480.0, 14257684480.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.06773082945081922, 0.06773082945081922, 0.06773082945081922]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[9868345344.0, 9868345344.0, 9868345344.0], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.05057695309321085, 0.05057695309321085, 0.05057695309321085, 0.05057695309321085]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[7789019136.0, 7789019136.0, 7789019136.0, 7789019136.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.04043149948120117, 0.04043149948120117, 0.04043149948120117, 0.04043149948120117, 0.04043149948120117]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[6374490112.0, 6374490112.0, 6374490112.0, 6374490112.0, 6374490112.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.03356948958502875, 0.03356948958502875, 0.03356948958502875, 0.03356948958502875, 0.03356948958502875, 0.03356948958502875]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[5604136277.333333, 5604136277.333333, 5604136277.333333, 5604136277.333333, 5604136277.333333, 5604136277.333333], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.028662145705450146, 0.028662145705450146, 0.028662145705450146, 0.028662145705450146, 0.028662145705450146, 0.028662145705450146, 0.028662145705450146]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4853755318.857142, 4853755318.857142, 4853755318.857142, 4853755318.857142, 4853755318.857142, 4853755318.857142, 4853755318.857142], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.025098903973897302, 0.025098903973897302, 0.025098903973897302, 0.025098903973897302, 0.025098903973897302, 0.025098903973897302, 0.025098903973897302, 0.025098903973897302]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4473421824.0, 4473421824.0, 4473421824.0, 4473421824.0, 4473421824.0, 4473421824.0, 4473421824.0, 4473421824.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.11877492268880208]}, act_mem={1: ['None']}, weight_mem=[14567211008.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.058781846364339196, 0.058781846364339196]}, act_mem={1: ['None', 'None']}, weight_mem=[8165654528.0, 8165654528.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.03920782936943902, 0.03920782936943902, 0.03920782936943902]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5893739861.333333, 5893739861.333333, 5893739861.333333], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.02938952048619588, 0.02938952048619588, 0.02938952048619588, 0.02938952048619588]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4831444992.0, 4831444992.0, 4831444992.0, 4831444992.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.08121371269226074]}, act_mem={1: ['None']}, weight_mem=[8674082816.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.04135800202687581, 0.04135800202687581]}, act_mem={1: ['None', 'None']}, weight_mem=[5568987136.0, 5568987136.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.0980211098988851]}, act_mem={1: ['None']}, weight_mem=[6527647744.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-70b': ProfilingResult(model_name='llama-2-70b', para_dict={ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.3412088765038384, 0.3412088765038384, 0.3412088765038384]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[47092793344.0, 47092793344.0, 47092793344.0], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.2559353073438009, 0.2559353073438009, 0.2559353073438009, 0.2559353073438009]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[35682189312.0, 35682189312.0, 35682189312.0, 35682189312.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.20483921686808268, 0.20483921686808268, 0.20483921686808268, 0.20483921686808268, 0.20483921686808268]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[28685251379.2, 28685251379.2, 28685251379.2, 28685251379.2, 28685251379.2], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.17045823997921414, 0.17045823997921414, 0.17045823997921414, 0.17045823997921414, 0.17045823997921414, 0.17045823997921414]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[24209369770.666668, 24209369770.666668, 24209369770.666668, 24209369770.666668, 24209369770.666668, 24209369770.666668], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.14596927279517763, 0.14596927279517763, 0.14596927279517763, 0.14596927279517763, 0.14596927279517763, 0.14596927279517763, 0.14596927279517763]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[20831656813.714287, 20831656813.714287, 20831656813.714287, 20831656813.714287, 20831656813.714287, 20831656813.714287, 20831656813.714287], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.12766122619311016, 0.12766122619311016, 0.12766122619311016, 0.12766122619311016, 0.12766122619311016, 0.12766122619311016, 0.12766122619311016, 0.12766122619311016]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[18439405568.0, 18439405568.0, 18439405568.0, 18439405568.0, 18439405568.0, 18439405568.0, 18439405568.0, 18439405568.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.2740472873051961, 0.2740472873051961]}, act_mem={1: ['None', 'None']}, weight_mem=[36090281984.0, 36090281984.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.18248818715413415, 0.18248818715413415, 0.18248818715413415]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[24566082218.666668, 24566082218.666668, 24566082218.666668], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.13699958721796673, 0.13699958721796673, 0.13699958721796673, 0.13699958721796673]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[18805555200.0, 18805555200.0, 18805555200.0, 18805555200.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.32747435569763184]}, act_mem={1: ['None']}, weight_mem=[36730306560.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.16427202224731444, 0.16427202224731444]}, act_mem={1: ['None', 'None']}, weight_mem=[19602866176.0, 19602866176.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.3181000709533691]}, act_mem={1: ['None']}, weight_mem=[20648820736.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0)}

'''
# New INT4
profiling_dict = {'falcon-7b': ProfilingResult(model_name='falcon-7b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.05745919545491536]}, act_mem={1: ['None']}, weight_mem=[5038604288.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.02744327386220296, 0.02744327386220296]}, act_mem={1: ['None', 'None']}, weight_mem=[2991783936.0, 2991783936.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.017580689324272997, 0.017580689324272997, 0.017580689324272997]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2342365866.6666665, 2342365866.6666665, 2342365866.6666665], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.01300495465596517, 0.01300495465596517, 0.01300495465596517, 0.01300495465596517]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2102067200.0, 2102067200.0, 2102067200.0, 2102067200.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.010530227025349932, 0.010530227025349932, 0.010530227025349932, 0.010530227025349932, 0.010530227025349932]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1779630080.0, 1779630080.0, 1779630080.0, 1779630080.0, 1779630080.0], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.008751681115892196, 0.008751681115892196, 0.008751681115892196, 0.008751681115892196, 0.008751681115892196, 0.008751681115892196]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1746774698.6666667, 1746774698.6666667, 1746774698.6666667, 1746774698.6666667, 1746774698.6666667, 1746774698.6666667], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.007513352802821568, 0.007513352802821568, 0.007513352802821568, 0.007513352802821568, 0.007513352802821568, 0.007513352802821568, 0.007513352802821568]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1526473874.2857144, 1526473874.2857144, 1526473874.2857144, 1526473874.2857144, 1526473874.2857144, 1526473874.2857144, 1526473874.2857144], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.006671718756357828, 0.006671718756357828, 0.006671718756357828, 0.006671718756357828, 0.006671718756357828, 0.006671718756357828, 0.006671718756357828, 0.006671718756357828]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1565720576.0, 1565720576.0, 1565720576.0, 1565720576.0, 1565720576.0, 1565720576.0, 1565720576.0, 1565720576.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'falcon-40b': ProfilingResult(model_name='falcon-40b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.28263643582661946]}, act_mem={1: ['None']}, weight_mem=[23296409600.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.13808027108510337, 0.13808027108510337]}, act_mem={1: ['None', 'None']}, weight_mem=[12171018240.0, 12171018240.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.09181104236178927, 0.09181104236178927, 0.09181104236178927]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[8496108885.333333, 8496108885.333333, 8496108885.333333], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.06859093109766642, 0.06859093109766642, 0.06859093109766642, 0.06859093109766642]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[6758268928.0, 6758268928.0, 6758268928.0, 6758268928.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.05498356183369953, 0.05498356183369953, 0.05498356183369953, 0.05498356183369953, 0.05498356183369953]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[5534790451.2, 5534790451.2, 5534790451.2, 5534790451.2, 5534790451.2], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.045347377989027236, 0.045347377989027236, 0.045347377989027236, 0.045347377989027236, 0.045347377989027236, 0.045347377989027236]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4883415040.0, 4883415040.0, 4883415040.0, 4883415040.0, 4883415040.0, 4883415040.0], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.038994730086553665, 0.038994730086553665, 0.038994730086553665, 0.038994730086553665, 0.038994730086553665, 0.038994730086553665, 0.038994730086553665]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[4237492224.0, 4237492224.0, 4237492224.0, 4237492224.0, 4237492224.0, 4237492224.0, 4237492224.0], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.033927524089813234, 0.033927524089813234, 0.033927524089813234, 0.033927524089813234, 0.033927524089813234, 0.033927524089813234, 0.033927524089813234, 0.033927524089813234]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[3958571008.0, 3958571008.0, 3958571008.0, 3958571008.0, 3958571008.0, 3958571008.0, 3958571008.0, 3958571008.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.16005951563517254]}, act_mem={1: ['None']}, weight_mem=[12871663616.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.07814775307973226, 0.07814775307973226]}, act_mem={1: ['None', 'None']}, weight_mem=[7286947840.0, 7286947840.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.052297141816880964, 0.052297141816880964, 0.052297141816880964]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[5331353600.0, 5331353600.0, 5331353600.0], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.039076141516367596, 0.039076141516367596, 0.039076141516367596, 0.039076141516367596]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[4361682944.0, 4361682944.0, 4361682944.0, 4361682944.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.10449522336324055]}, act_mem={1: ['None']}, weight_mem=[8181252096.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.0521560271581014, 0.0521560271581014]}, act_mem={1: ['None', 'None']}, weight_mem=[5298716672.0, 5298716672.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.1294175148010254]}, act_mem={1: ['None']}, weight_mem=[6623330304.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'gptj-6b': ProfilingResult(model_name='gptj-6b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.05062734285990396]}, act_mem={1: ['None']}, weight_mem=[4667408384.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.02392036914825439, 0.02392036914825439]}, act_mem={1: ['None', 'None']}, weight_mem=[2816671744.0, 2816671744.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.015563938352796769, 0.015563938352796769, 0.015563938352796769]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2247294976.0, 2247294976.0, 2247294976.0], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.011343125502268469, 0.011343125502268469, 0.011343125502268469, 0.011343125502268469]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2026569728.0, 2026569728.0, 2026569728.0, 2026569728.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.009205296834309897, 0.009205296834309897, 0.009205296834309897, 0.009205296834309897, 0.009205296834309897]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1724684697.6, 1724684697.6, 1724684697.6, 1724684697.6, 1724684697.6], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.007642822795444063, 0.007642822795444063, 0.007642822795444063, 0.007642822795444063, 0.007642822795444063, 0.007642822795444063]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1717065045.3333333, 1717065045.3333333, 1717065045.3333333, 1717065045.3333333, 1717065045.3333333, 1717065045.3333333], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.006605459394909086, 0.006605459394909086, 0.006605459394909086, 0.006605459394909086, 0.006605459394909086, 0.006605459394909086, 0.006605459394909086]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1510895030.857143, 1510895030.857143, 1510895030.857143, 1510895030.857143, 1510895030.857143, 1510895030.857143, 1510895030.857143], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.005783490339914958, 0.005783490339914958, 0.005783490339914958, 0.005783490339914958, 0.005783490339914958, 0.005783490339914958, 0.005783490339914958, 0.005783490339914958]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1561264128.0, 1561264128.0, 1561264128.0, 1561264128.0, 1561264128.0, 1561264128.0, 1561264128.0, 1561264128.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.03391480445861816]}, act_mem={1: ['None']}, weight_mem=[3282436096.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.01607975165049235, 0.01607975165049235]}, act_mem={1: ['None', 'None']}, weight_mem=[2462449664.0, 2462449664.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.011033217112223307, 0.011033217112223307, 0.011033217112223307]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2138090154.6666667, 2138090154.6666667, 2138090154.6666667], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.008615616957346594, 0.008615616957346594, 0.008615616957346594, 0.008615616957346594]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1961754624.0, 1961754624.0, 1961754624.0, 1961754624.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.04838765462239582]}, act_mem={1: ['None']}, weight_mem=[3028025344.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.024593321482340492, 0.024593321482340492]}, act_mem={1: ['None', 'None']}, weight_mem=[2742812672.0, 2742812672.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.15813082059224445]}, act_mem={1: ['None']}, weight_mem=[3676569600.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-7b': ProfilingResult(model_name='llama-2-7b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.0566195011138916]}, act_mem={1: ['None']}, weight_mem=[4845666304.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.02703485488891601, 0.02703485488891601]}, act_mem={1: ['None', 'None']}, weight_mem=[2896363520.0, 2896363520.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.017383734385172527, 0.017383734385172527, 0.017383734385172527]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2280849408.0, 2280849408.0, 2280849408.0], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.01283976634343465, 0.01283976634343465, 0.01283976634343465, 0.01283976634343465]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2087387136.0, 2087387136.0, 2087387136.0, 2087387136.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.0103921635945638, 0.0103921635945638, 0.0103921635945638, 0.0103921635945638, 0.0103921635945638]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[1777952358.4, 1777952358.4, 1777952358.4, 1777952358.4, 1777952358.4], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.008619909816318086, 0.008619909816318086, 0.008619909816318086, 0.008619909816318086, 0.008619909816318086, 0.008619909816318086]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1770192896.0, 1770192896.0, 1770192896.0, 1770192896.0, 1770192896.0, 1770192896.0], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.007379770278930662, 0.007379770278930662, 0.007379770278930662, 0.007379770278930662, 0.007379770278930662, 0.007379770278930662, 0.007379770278930662]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1551340105.142857, 1551340105.142857, 1551340105.142857, 1551340105.142857, 1551340105.142857, 1551340105.142857, 1551340105.142857], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.006487254301706951, 0.006487254301706951, 0.006487254301706951, 0.006487254301706951, 0.006487254301706951, 0.006487254301706951, 0.006487254301706951, 0.006487254301706951]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[1592721408.0, 1592721408.0, 1592721408.0, 1592721408.0, 1592721408.0, 1592721408.0, 1592721408.0, 1592721408.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.03852728207906086]}, act_mem={1: ['None']}, weight_mem=[3349544960.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.01847244103749593, 0.01847244103749593]}, act_mem={1: ['None', 'None']}, weight_mem=[2522218496.0, 2522218496.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.012473678588867188, 0.012473678588867188, 0.012473678588867188]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2163955029.3333335, 2163955029.3333335, 2163955029.3333335], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.00950296322504679, 0.00950296322504679, 0.00950296322504679, 0.00950296322504679]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[1976434688.0, 1976434688.0, 1976434688.0, 1976434688.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.0815377394358317]}, act_mem={1: ['None']}, weight_mem=[3058434048.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.03968414465586344, 0.03968414465586344]}, act_mem={1: ['None', 'None']}, weight_mem=[2714501120.0, 2714501120.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-13b': ProfilingResult(model_name='llama-2-13b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.1021501064300537]}, act_mem={1: ['None']}, weight_mem=[8408727552.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.049691836039225265, 0.049691836039225265]}, act_mem={1: ['None', 'None']}, weight_mem=[4706205696.0, 4706205696.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.03202643394470215, 0.03202643394470215, 0.03202643394470215]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[3491605162.6666665, 3491605162.6666665, 3491605162.6666665], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.023851199944814043, 0.023851199944814043, 0.023851199944814043, 0.023851199944814043]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[3008036864.0, 3008036864.0, 3008036864.0, 3008036864.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.01890976270039876, 0.01890976270039876, 0.01890976270039876, 0.01890976270039876, 0.01890976270039876]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[2531668787.2, 2531668787.2, 2531668787.2, 2531668787.2, 2531668787.2], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.015592696931627058, 0.015592696931627058, 0.015592696931627058, 0.015592696931627058, 0.015592696931627058, 0.015592696931627058]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2397940394.6666665, 2397940394.6666665, 2397940394.6666665, 2397940394.6666665, 2397940394.6666665, 2397940394.6666665], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.013206908816382998, 0.013206908816382998, 0.013206908816382998, 0.013206908816382998, 0.013206908816382998, 0.013206908816382998, 0.013206908816382998]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2098696777.142857, 2098696777.142857, 2098696777.142857, 2098696777.142857, 2098696777.142857, 2098696777.142857, 2098696777.142857], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.011550289392471312, 0.011550289392471312, 0.011550289392471312, 0.011550289392471312, 0.011550289392471312, 0.011550289392471312, 0.011550289392471312, 0.011550289392471312]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[2073493504.0, 2073493504.0, 2073493504.0, 2073493504.0, 2073493504.0, 2073493504.0, 2073493504.0, 2073493504.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.06453189849853516]}, act_mem={1: ['None']}, weight_mem=[5137367040.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.03134393692016601, 0.03134393692016601]}, act_mem={1: ['None', 'None']}, weight_mem=[3350069248.0, 3350069248.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.02073634995354546, 0.02073634995354546, 0.02073634995354546]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[2759196672.0, 2759196672.0, 2759196672.0], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.015574208895365396, 0.015574208895365396, 0.015574208895365396, 0.015574208895365396]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[2436497408.0, 2436497408.0, 2436497408.0, 2436497408.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.0517934481302897]}, act_mem={1: ['None']}, weight_mem=[4027318272.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.02662625312805176, 0.02662625312805176]}, act_mem={1: ['None', 'None']}, weight_mem=[3188981760.0, 3188981760.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.07694344520568848]}, act_mem={1: ['None']}, weight_mem=[4087349248.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0),
 'llama-2-70b': ProfilingResult(model_name='llama-2-70b', para_dict={ParallelConfig(dp=1, op=1, pp=1): LatencyMemData(latency={1: [0.45967704455057784]}, act_mem={1: ['None']}, weight_mem=[36317626368.0], metadata=None), ParallelConfig(dp=1, op=1, pp=2): LatencyMemData(latency={1: [0.2258474588394165, 0.2258474588394165]}, act_mem={1: ['None', 'None']}, weight_mem=[18687918080.0, 18687918080.0], metadata=None), ParallelConfig(dp=1, op=1, pp=3): LatencyMemData(latency={1: [0.14919086032443576, 0.14919086032443576, 0.14919086032443576]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[12867971754.666666, 12867971754.666666, 12867971754.666666], metadata=None), ParallelConfig(dp=1, op=1, pp=4): LatencyMemData(latency={1: [0.11182003418604533, 0.11182003418604533, 0.11182003418604533, 0.11182003418604533]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[10011475968.0, 10011475968.0, 10011475968.0, 10011475968.0], metadata=None), ParallelConfig(dp=1, op=1, pp=5): LatencyMemData(latency={1: [0.09033302942911783, 0.09033302942911783, 0.09033302942911783, 0.09033302942911783, 0.09033302942911783]}, act_mem={1: ['None', 'None', 'None', 'None', 'None']}, weight_mem=[8159585894.4, 8159585894.4, 8159585894.4, 8159585894.4, 8159585894.4], metadata=None), ParallelConfig(dp=1, op=1, pp=6): LatencyMemData(latency={1: [0.07463339964548747, 0.07463339964548747, 0.07463339964548747, 0.07463339964548747, 0.07463339964548747, 0.07463339964548747]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[7077385557.333333, 7077385557.333333, 7077385557.333333, 7077385557.333333, 7077385557.333333, 7077385557.333333], metadata=None), ParallelConfig(dp=1, op=1, pp=7): LatencyMemData(latency={1: [0.06445881525675456, 0.06445881525675456, 0.06445881525675456, 0.06445881525675456, 0.06445881525675456, 0.06445881525675456, 0.06445881525675456]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[6135714377.142858, 6135714377.142858, 6135714377.142858, 6135714377.142858, 6135714377.142858, 6135714377.142858, 6135714377.142858], metadata=None), ParallelConfig(dp=1, op=1, pp=8): LatencyMemData(latency={1: [0.05595934987068176, 0.05595934987068176, 0.05595934987068176, 0.05595934987068176, 0.05595934987068176, 0.05595934987068176, 0.05595934987068176, 0.05595934987068176]}, act_mem={1: ['None', 'None', 'None', 'None', 'None', 'None', 'None', 'None']}, weight_mem=[5606670336.0, 5606670336.0, 5606670336.0, 5606670336.0, 5606670336.0, 5606670336.0, 5606670336.0, 5606670336.0], metadata=None), ParallelConfig(dp=1, op=2, pp=1): LatencyMemData(latency={1: [0.2669621626536051]}, act_mem={1: ['None']}, weight_mem=[19115933696.0], metadata=None), ParallelConfig(dp=1, op=2, pp=2): LatencyMemData(latency={1: [0.13035577932993572, 0.13035577932993572]}, act_mem={1: ['None', 'None']}, weight_mem=[10407510016.0, 10407510016.0], metadata=None), ParallelConfig(dp=1, op=2, pp=3): LatencyMemData(latency={1: [0.08601032363043891, 0.08601032363043891, 0.08601032363043891]}, act_mem={1: ['None', 'None', 'None']}, weight_mem=[7468001962.666667, 7468001962.666667, 7468001962.666667], metadata=None), ParallelConfig(dp=1, op=2, pp=4): LatencyMemData(latency={1: [0.06476279099782309, 0.06476279099782309, 0.06476279099782309, 0.06476279099782309]}, act_mem={1: ['None', 'None', 'None', 'None']}, weight_mem=[5943197696.0, 5943197696.0, 5943197696.0, 5943197696.0], metadata=None), ParallelConfig(dp=1, op=4, pp=1): LatencyMemData(latency={1: [0.17800644238789876]}, act_mem={1: ['None']}, weight_mem=[11053826048.0], metadata=None), ParallelConfig(dp=1, op=4, pp=2): LatencyMemData(latency={1: [0.08794283866882324, 0.08794283866882324]}, act_mem={1: ['None', 'None']}, weight_mem=[6740770816.0, 6740770816.0], metadata=None), ParallelConfig(dp=1, op=8, pp=1): LatencyMemData(latency={1: [0.22793747584025065]}, act_mem={1: ['None']}, weight_mem=[7787249664.0], metadata=None)}, preprocess_cpu=0.0, postprocess_cpu=0.0)}
'''

def load_test_prof_result_v2(name: str):
    # with open('/home/dl37958/ALPASERVE/mms/baseline_test/profiling_dict.pkl', 'rb') as f:
    #     loaded_profiling_dict = pickle.load(f)
    #     print(loaded_profiling_dict)
    
    return profiling_dict[name]